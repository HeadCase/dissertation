#  Load some libraries and ancillary bits
library(tidyverse)
# library(forcats)
# library(lubridate)
# library(scales)
library(extrafont)
library(extrafontdb)
loadfonts()
fonts()
# Set up look and feel of ggplots
theme_update(
text = element_text(family = "Source Sans Pro"),
plot.title = element_text(size = 18),
plot.subtitle = element_text(size = 14),
plot.margin = margin(5, 60, 5, 5),
axis.text = element_text(size = 14),
axis.title.x = element_text(margin = margin(10, 0, 0, 0)),
axis.title.y = element_text(margin = margin(0, 10, 0, 0)),
axis.text.y = element_text(margin = margin(5, 5, 5, 5)),
axis.text.x = element_text(margin = margin(5, 5, 5, 5)),
axis.title = element_text(size = 14),
strip.text = element_text(size = 12),
legend.text = element_text(size = 14),
legend.title = element_text(size = 14),
legend.background = element_rect(colour = "darkgrey", fill = "white"),
legend.key = element_rect(
colour = "transparent",
fill = "transparent"
),
)
# Read in data
elect <- read_csv("../redist/elections/1mil-iters-exp-graph.csv",
col_names = c("index", "plan_id", "plan_label", "distr", "vote_circ", "vote_sqre", "total"),
col_types = "idifiii",
skip = 1
)
elect <- mutate(elect, circ_marg = (vote_circ / total - vote_sqre / total) * 100, sqre_marg = (vote_sqre / total - vote_circ / total) * 100)
elect <- mutate(elect, winner = ifelse(circ_marg > sqre_marg,'circle', 'square'))
ggplot(elect, aes(total))+geom_histogram(binwidth = 1)
ggplot(elect, aes(distr, total, group = distr, fill = distr)) +
geom_boxplot() +
scale_fill_manual(name='District', values = c("#46AC90", "#FA6A34", "#6981BA", "#DF5EAE", "#89BF2B", "#E6BC00"))
ggplot(elect, aes(distr, circ_marg, group = distr, fill = distr)) +
geom_boxplot()+
scale_fill_manual(name='District', values = c("#46AC90", "#FA6A34", "#6981BA", "#DF5EAE", "#89BF2B", "#E6BC00"))
ggplot(elect, aes(distr, sqre_marg, group = distr, fill = distr)) +
geom_boxplot()+
scale_fill_manual(name='District', values = c("#46AC90", "#FA6A34", "#6981BA", "#DF5EAE", "#89BF2B", "#E6BC00"))
distrs = group_by(elect, distr)
win_count_by_plan = group_by(elect, plan_label) %>% count(winner)
ggplot(distrs, aes(distr))+geom_histogram(stat='count')+facet_wrap(~winner)
ggplot(win_count_by_plan, aes(n))+geom_histogram(binwidth = 1)+facet_wrap(~winner)
